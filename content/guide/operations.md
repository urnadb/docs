---
title: API äº¤äº’
type: docs
prev: guide/tls-http
weight: 7
---

UrnaDB å†…éƒ¨æä¾›äº†å¤šç§æ•°æ®ç»“æ„æŠ½è±¡ï¼Œä¾‹å¦‚ Table ã€Record ã€ Variant ã€Lock ç±»å‹ï¼Œè¿™äº›æ•°æ®ç±»å‹å¯¹åº”ç€å¸¸è§çš„ä¸šåŠ¡ä»£ç æ‰€éœ€ä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚åç»­çš„æ–‡æ¡£ç»Ÿä¸€ç§°ä¹‹ä¸º NameSpace å‘½åç©ºé—´ï¼ŒåŒä¸€å‘½åç©ºé—´ä¸­å­˜å‚¨éƒ½æ˜¯åŒä¸€ç±»å‹çš„æ•°æ®æ¨¡å‹çš„æ•°æ®ï¼Œäº†è§£ä¸åŒå‘½åç©ºé—´çš„æ•°æ®æ¨¡å‹åŠå…¶ç‰¹æ€§ï¼Œæœ‰åŠ©äºå¼€å‘è€…æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„æ•°æ®æ¨¡å‹ï¼Œä»è€Œé«˜æ•ˆå®ç°ä¸Šå±‚ä¸šåŠ¡åŠŸèƒ½ã€‚

> [!IMPORTANT]
> å®¢æˆ·ç«¯ä¸ UrnaDB æœåŠ¡ç«¯ä¹‹é—´çš„æ•°æ®äº¤äº’é€šè¿‡ **PQL** åè®®ï¼ŒPQLï¼ˆPatch Query Languageï¼‰æ˜¯ä¸€ç§åŸºäº HTTP + JSON çš„æ•°æ®æ“ä½œä¸æŸ¥è¯¢åè®®ï¼Œä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ç»“æ„åŒ–æ•°æ®äº¤æ¢æä¾›äº†ç»Ÿä¸€ã€ç®€å•ä¸”å¯æ‰©å±•çš„æ¥å£ï¼Œä»»ä½•èƒ½å¤Ÿå‘èµ· HTTP è¯·æ±‚çš„è½¯ä»¶éƒ½å¯ä»¥ä½œä¸º PQL å®¢æˆ·ç«¯ï¼›ä»¥ä¸‹å†…å®¹å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ PQL API ä¸æœåŠ¡å™¨è¿›è¡Œæ•°æ®äº¤æ¢ç¤ºä¾‹ã€‚

**PQL** åè®®ç»Ÿä¸€è¿”å›çš„æ•°æ®æ ¼å¼ä¸º JSON æ ¼å¼ï¼ŒåŒ…æ‹¬ 3 ä¸ªå­—æ®µ **status** å’Œ **message** ã€**data** å­—æ®µï¼Œå…¶ä¸­ **status** å­—æ®µæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå€¼å¯ä»¥ **success | error** å…¶ä¸­ä¸€ç§ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ ¹æ®æ­¤å­—æ®µåˆ¤æ–­äº‹ç‰©æ“ä½œæ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼›**message** çš„å€¼ä¸ºç»™äººç±»é˜…è¯»çš„æ¶ˆæ¯ï¼Œ**data** å­—æ®µçš„å€¼æ˜¯ä¸€ä¸ª JSON Object å¯¹è±¡ï¼Œå¯ä»¥æ˜¯ JSON å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ã€‚

```json
{
    "status": "success",
    "message": "server output text message",
    "data": ...
}
```


## ğŸ“ˆ Table å‘½åç©ºé—´

> [!TIP]
> **Table** å‘½åç©ºé—´çš„ç»“æ„ç±»ä¼¼å…³ç³»æ•°æ®åº“ SQL ä¸­çš„ä¸€å¼ è¡¨ç»“æ„ï¼Œä¸€æ—¦åˆ›å»ºå®Œæˆä¹‹å Table ä¼šä¸ºæ¯æ¡è®°å½•åˆ†é…ä¸€ä¸ªå…¨å±€å”¯ä¸€é€’å¢çš„ `t_id` ç´¢å¼•ï¼ŒTable çš„æ¯åˆ—å¯ä»¥å­˜å‚¨ä»»ä½•æœ‰æ˜ å°„å…³ç³»çš„åŠç»“æ„åŒ–æ•°æ®ï¼Œä¾‹å¦‚ç¼–ç¨‹è¯­è¨€ä¸­çš„ struct å’Œ class å­—æ®µéƒ½å¯ä»¥ä½¿ç”¨ Table è¿›è¡Œå­˜å‚¨ã€‚ç›¸æ¯”äºå…³ç³»æ•°æ®åº“ SQL ä¸­è¡¨æœ‰æ›´é«˜çš„çµæ´»æ€§ï¼Œä¸éœ€è¦æå‰å®šä¹‰è¡¨ schema ç»“æ„ï¼Œå¯ä»¥åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­çµæ´»çš„åŠ¨æ€æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹è¿™äº›è®°å½•å­—æ®µã€‚


åˆ›å»ºä¸€å¼ åä¸º **users** çš„ Table å‘½åç©ºé—´ï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºæ•°æ®è¡¨ã€‚ç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `CREATE TABLE ... { ... }` è¯­å¥ï¼Œä½†åŒºåˆ«äºä¸éœ€è¦æå‰å®šä¹‰è¡¨ schema ç»“æ„ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X PUT http://192.168.31.221:2668/tables/users \
  -H "Auth-Token: 73suyb7iNeZsmqhvaxgEn7Ug2"
```

å¦‚æœä¸Šé¢æ“ä½œæ‰§è¡ŒæˆåŠŸï¼Œä¼šåˆ›å»ºä¸€ä¸ª **users** çš„å‘½åç©ºé—´ï¼Œè¿™ä¸ª **users** å‘½åç©ºé—´åç»­å¯ä»¥å­˜æ”¾æ›´å¤šæ•°æ®è®°å½•ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table created successfully"
}
```

> [!IMPORTANT]
> åœ¨åˆ›å»ºå‘½åç©ºé—´çš„æ—¶å€™å¯ä»¥æŒ‡å®šè¯¥å‘½åç©ºé—´çš„ç”Ÿå‘½å‘¨æœŸï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡è¯¥å‘½åç©ºé—´åˆ›å»ºä¹‹åèƒ½å­˜æ´»å¤šä¹…ï¼Œä»¥ç§’ä¸ºå•ä½ï¼Œå½“åˆ°è¾¾æœŸé™å UrnaDB çš„åƒåœ¾å›æ”¶å™¨ä¼šä¸»åŠ¨åˆ é™¤è¯¥å‘½åç©ºé—´é‡Šæ”¾å…¶å ç”¨çš„å­˜å‚¨ç©ºé—´ã€‚


ä¾‹å¦‚åœ¨åˆ›å»º **users** æ—¶é€šè¿‡ `ttl` å­—æ®µæ¥æŒ‡å®šå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸º 1800 ç§’ï¼Œåœ¨ 1800 ç§’ä¹‹åä¼šè¢«åƒåœ¾å›æ”¶å™¨ä¸»åŠ¨åˆ é™¤ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X PUT "http://192.168.31.221:2668/tables/users" \
  -H "Auth-Token: 73suyb7iNeZsmqhvaxgEn7Ug2" \
  -H "Content-Type: application/json" \
  -d '{
    "ttl": 1800
  }'
```

ä¸‹é¢æ˜¯ Table å‘½åç©ºé—´ä¸­çš„ Rows ç»“æ„çš„å®Œæ•´ JSON æŠ½è±¡ï¼ŒTable å‘½åç©ºé—´ä¸­çš„æ¯æ¡æ•°æ®è®°å½•çš„ schema å¸ƒå±€æ˜¯ä¸åŒçš„ï¼Œå…¶ä¸­çš„ `t_id` ä¸ºæ•°æ®åº“ä¸»åŠ¨åˆ†é…çš„è‡ªå¢ä¸»é”®ï¼š

```json
{
    "table": {
        "1": {
            "active": true,
            "age": 25,
            "name": "Leon Ding",
            "score": 95.5,
            "tags": [
                "admin",
                "user"
            ]
        },
        "2": {
            "active": false,
            "age": 30,
            "name": "Alice Wang",
            "config": {
                "font": 14,
                "theme": "dark"
            },
            "email": "example@xxx.com"
        },
        "3": {}
    },
    "t_id": 4
}
```

å‘ **users** å‘½åç©ºé—´ä¸­æ’å…¥ä¸€æ¡æ•°æ®è®°å½•ï¼Œè¿™æ¡æ“ä½œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `INSERT ... INTO ... VALUES ...` è¯­å¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X POST "http://192.168.101.252:2668/tables/users/rows" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "rows": {
      "name": "Leon Ding",
      "age": 25,
      "active": true,
      "score": 95.5,
      "tags": ["admin", "user"],
      "meta": {
        "editor": "system"
      }
    }
  }'
```

ä¸Šé¢å‘½ä»¤ä¼šæ‰§è¡ŒæˆåŠŸä¹‹åä¼šè¿”å›å¯¹åº”è®°å½•çš„ä¸»é”® `t_id` å­—æ®µï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table rows insert successfully",
    "data": {
        "t_id": 1
    }
}
```

ä» **users** çš„å‘½åç©ºé—´ä¸­æŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®è®°å½•ï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `SELECT * FROM ...` è¯­å¥ï¼Œä¹Ÿç±»ä¼¼äºå…¶ä»–æ–‡æ¡£å‹æ•°æ®åº“ MongoDB ä¸­çš„ `findAll` æ“ä½œï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X GET "http://192.168.31.221:2668/tables/users" \
  -H "Auth-Token: 73suyb7iNeZsmqhvaxgEn7Ug2"
```

å¦‚æœä¸Šé¢æ“ä½œæ‰§è¡ŒæˆåŠŸä¼šè¿”å›è¯¥å‘½åç©ºé—´ä¸­æ‰€æœ‰çš„æ•°æ®è®°å½•ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table queried successfully",
    "data": {
        "1": {
            "active": true,
            "age": 25,
            "meta": {
                "editor": "system"
            },
            "name": "Leon Ding",
            "score": 95.5,
            "tags": [
                "admin",
                "user"
            ]
        }
    }
}
```

ä»åä¸º **users** çš„å‘½åç©ºé—´ä¸­æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `SELECT * FROM ... WHERE ...` çš„è¯­å¥ï¼ŒæŸ¥è¯¢æ¡ä»¶æ˜¯è¡¨ä¸­ **name** å­—æ®µçš„å€¼ä¸º **Leon Ding** çš„è®°å½•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X GET "http://192.168.31.221:2668/tables/users/rows" \
  -H "Auth-Token: ex224JWgK5H6sKhpNk5ZbWKzM" \
  -H "Content-Type: application/json" \
  -d '{
    "wheres": {
      "name": "Leon Ding"
    }
  }'
```

å¦‚æœä¸Šé¢æ“ä½œæ‰§è¡ŒæˆåŠŸä¼šè¿”å›è¯¥å‘½åç©ºé—´ä¸­åŒ¹é…åˆ°çš„æ•°æ®è®°å½•ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table queried rows successfully",
    "data": [
        {
            "active": true,
            "age": 25,
            "meta": {
                "editor": "system"
            },
            "name": "Leon Ding",
            "score": 95.5,
            "tags": [
                "admin",
                "user"
            ]
        }
    ]
}
```

æ ¹æ®æŒ‡å®šçš„ç­›é€‰æ¡ä»¶ï¼Œå¯¹ **users** å‘½åç©ºé—´ä¸­çš„æ•°æ®è®°å½•è¿›è¡Œéƒ¨åˆ†å­—æ®µçš„å†…å®¹æ›´æ–°æ“ä½œï¼Œè¿™ä¸ªæ“ä½œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `UPDATE ... SET ... WHERE ... `è¯­å¥ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X PATCH "http://192.168.31.221:2668/tables/users" \
  -H "Auth-Token: ex224JWgK5H6sKhpNk5ZbWKzM" \
  -H "Content-Type: application/json" \
  -d '{
    "wheres": {
      "name": "Leon Ding",
      "active": true
    },
    "sets": {
      "age": 26,
      "name": "Leon",
      "meta": {
        "editor": "system"
      }
    }
  }'
```

å¦‚æœä¸Šé¢æ“ä½œæ‰§è¡ŒæˆåŠŸï¼Œä¼šä¿®æ”¹è¯¥å‘½åç©ºé—´ä¸­æ‰€åŒ¹é…åˆ°æ•°æ®è®°å½•ä¸­çš„å€¼ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table rows patched successfully"
}
```

å¯¹ **users** å‘½åç©ºé—´ä¸­å·²æœ‰çš„æ•°æ®è®°å½•æ‰§è¡Œæ¡ä»¶åˆ é™¤æ“ä½œï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `DELETE FROM ... WHERE ...` çš„è¯­å¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X DELETE "http://192.168.31.221:2668/tables/users/rows" \
  -H "Auth-Token: NjqwUvtNP6XQGeABhgwXIDcNw" \
  -H "Content-Type: application/json" \
  -d '{
    "wheres": {
      "name": "Leon Ding"
    }
  }'
```

å¦‚æœä¸Šé¢æ“ä½œæ‰§è¡ŒæˆåŠŸï¼Œä¼šåˆ é™¤è¯¥å‘½åç©ºé—´ä¸­æ‰€åŒ¹é…åˆ°æ•°æ®è®°å½•ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table rows remove successfully"
}
```

ä¸‹é¢æ“ä½œä¼šåˆ é™¤ **users** å‘½åç©ºé—´ï¼Œè¿™æ„å‘³ç€ **users** å‘½åç©ºé—´ä¸­å­˜å‚¨çš„æ•°æ®è®°å½•éƒ½ä¼šè¢«åˆ é™¤ï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `DROP TABLE ...` è¯­å¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X DELETE "http://192.168.31.221:2668/tables/users" \
  -H "Auth-Token: 43CmqMY6r7jndrjUC7cxyJ1SV"
```

å¦‚æœä¸Šé¢æ“ä½œæ‰§è¡ŒæˆåŠŸä¼šåˆ é™¤è¯¥å‘½åç©ºé—´æ‰€æœ‰æ•°æ®ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "table deleted successfully"
}
```

> [!WARNING]
> Table æ˜¯ä¸€ç»„å¤šä¸ªå¯¹è±¡è®°å½•ç»„æˆé›†åˆï¼ŒåŒä¸€ä¸ª Table å‘½åç©ºé—´éšç€ä¸æ–­æ’å…¥æ–°çš„æ•°æ®ï¼Œä¼šå¯¼è‡´ Table è¶Šæ¥è¶Šå¤§å¹¶ä¸”æœ‰é”çš„å¼€é”€ï¼Œå¤šæ¡è®°å½•å…±äº«ä¸€æŠŠ Table é”æœ‰æ€§èƒ½æŸå¤±ï¼Œæ‰€æœ‰ä¸å»ºè®®åœ¨å•ä¸ª Table å‘½åç©ºé—´ä¸­å­˜å‚¨æ•°æ®è¾ƒå¤šæ•°æ®è®°å½•ã€‚

## ğŸ“‚ Record å‘½åç©ºé—´

> [!TIP]
> **Record** å‘½åç©ºé—´çš„ç»“æ„ç±»ä¼¼ MongoDB ä¸­çš„ Document ç»“æ„ï¼ŒRecord é€šå¸¸ç›´æ¥æ˜ å°„ç¼–ç¨‹è¯­è¨€ä¸­çš„ class çš„ä¸€æ¡è®°å½•ï¼ŒOOP é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„å¯¹è±¡å¯ä»¥ç›´æ¥æ˜ å°„ä¸º Record è®°å½•ã€‚åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ Record ä¸€æ¡è®°å½•å¯¹åº”ä¸€æŠŠé”ï¼Œæœ‰ç€äº‹ç‰©å¤„ç†æ€§èƒ½é«˜çš„ä¼˜åŠ¿ã€‚Record ä¸€æ®µåˆ›å»ºå°±ä¸èƒ½æ”¹äº†ï¼Œé€‚åº”åœºæ™¯å°±æ˜¯æ›´æ–°ä¸é¢‘ç¹çš„æ•°æ®ï¼Œä¾‹å¦‚ç¤¾äº¤è®ºå›ç³»ç»Ÿä¸­å¸–å­åŠŸèƒ½ï¼Œä¸€æ¡å¸–å­å¯ä»¥å¯¹åº”ä¸€æ¡ Record è®°å½•ï¼Œå¦‚æœæ›´æ–°äº†ç›´æ¥è®¾ç½®ä¸€æ¡æ–°çš„ Record æ˜ å°„å³å¯ã€‚


åˆ›å»ºä¸€æ¡åä¸º **142857** çš„ Record å‘½åç©ºé—´ï¼Œå¹¶è®¾ç½®æ‰€éœ€å­˜å‚¨çš„æ•°æ®è®°å½•å€¼ã€‚ä¾‹å¦‚ä¸€å¼ å¸–å­çš„æŠ½è±¡ï¼Œæ“ä½œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X PUT "http://192.168.101.252:2668/records/142857" \
  -H "Content-Type: application/json" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -d '{
    "record": {
      "title": "Hello UrnaDB: My First Post",
      "author": "Leon Ding",
      "content": "This is a forum post stored inside UrnaDB.\n\n",
      "category": "tech",
      "tags": ["nosql", "database"],
      "views": 123,
      "published": true
    },
    "ttl": 3600
  }'
```

ä¸Šé¢å‘½ä»¤æ‰§è¡ŒæˆåŠŸä¹‹å HTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "record created successfully"
}
```

> [!IMPORTANT]
> è¿™ä¸ª **142857** å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç¯‡æ–‡ç« çš„ POST ID ç¼–å·ï¼Œä¸šåŠ¡å±‚åªéœ€è¦æä¾›è¿™ä¸ª ID å°±å¯ä»¥æŸ¥è¯¢åˆ°è¿™æ¡å¸–å­æ•°æ®ï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­ä¸€æ¡è®°å½•çš„å”¯ä¸€ä¸»é”®ï¼›åŒæ ·åœ¨åˆ›å»º Record è®°å½•æ•°æ®æ—¶å¯ä»¥æŒ‡å®š `ttl` å­—æ®µï¼Œ`ttl` çš„å€¼å•ä½æ˜¯ç§’ç”¨æ¥è®¾ç½® Record çš„ç”Ÿå‘½å‘¨æœŸã€‚

åœ¨ Record å‘½åç©ºé—´ä¸­æŸ¥è¯¢ä¸€æ¡åä¸º **142857** çš„æ•°æ®è®°å½•ï¼Œæ“ä½œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X GET http://192.168.31.221:2668/records/142857 \
  -H "Auth-Token: dw8PDCPRQcrIVIekL4UheS9ra"
```

å¦‚æœæ‰§è¡ŒæˆåŠŸä¼šè¿”å› **142857** ä¸­å­˜å‚¨çš„å®Œæ•´æ•°æ®è®°å½•ï¼š

```json
{
    "status": "success",
    "message": "record queried successfully",
    "data": {
        "author": "Leon Ding",
        "category": "tech",
        "content": "This is a forum post stored inside UrnaDB.\n\n",
        "published": true,
        "tags": [
            "nosql",
            "database"
        ],
        "title": "Hello UrnaDB: My First Post",
        "views": 123
    }
}
```

å¯¹å·²å­˜åœ¨çš„ **142857** æ•°æ®è®°å½•æŸ¥è¯¢æŸä¸ª `column` æ“ä½œï¼Œç±»ä¼¼äºå…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `SELECT column FROM ...` è¯­å¥ï¼Œä¾‹å¦‚æœç´¢æŸ¥è¯¢æ“ä½œç¤ºä¾‹ï¼š

```bash
curl -X POST "http://192.168.101.252:2668/records/142857" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "column": "tags"
  }'
```

å¦‚æœä¸Šé¢è¯·æ±‚æ‰§è¡ŒæˆåŠŸï¼Œä¼šè¿”å› **142857** ä¸­ `tags` å­—æ®µæ‰€å­˜å‚¨çš„æ•°æ®è®°å½•ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "search completed successfully",
    "data": [
        [
            "nosql",
            "database"
        ]
    ]
}
```

å¯¹å·²ç»å­˜åœ¨çš„ **142857** è®°å½•æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œè¿™ä¸ªå¯¹åº”ç€å…³ç³»æ•°æ®åº“ SQL ä¸­çš„ `DROP TABLE ...` è¯­å¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```bash
curl -X DELETE "http://192.168.101.252:2668/records/142857" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI"
```

å¦‚æœä¸Šé¢è¯·æ±‚æ‰§è¡ŒæˆåŠŸä¼šåˆ é™¤å¯¹åº”çš„ **142857** ä¸­æ‰€å­˜å‚¨çš„æ•°æ®è®°å½•ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "record deleted successfully"
}
```

## ğŸ“¦ Variant å‘½åç©ºé—´

> [!TIP]
> **Variant** å‘½åç©ºé—´æ˜¯ä¸€ä¸ªé€šç”¨çš„åŠ¨æ€æ•°æ®å®¹å™¨ï¼Œå¯ç”¨äºå­˜å‚¨å¤šç§åŸºç¡€æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ Stringã€Booleanã€Integer å’Œ Double ç­‰ï¼Œå®ƒä¸ºä¸åŒç±»å‹çš„æ•°æ®æä¾›äº†ç»Ÿä¸€çš„ APIï¼Œä½¿ä¸šåŠ¡å±‚èƒ½å¤Ÿä»¥ä¸€è‡´ä¸”çµæ´»çš„æ–¹å¼è¿›è¡Œæ“ä½œã€‚


åœ¨ Variant å‘½åç©ºé—´ä¸­ï¼Œå…·ä½“çš„æ•°æ®ç±»å‹ç”±é¦–æ¬¡å†™å…¥çš„å€¼å†³å®šï¼Œå¹¶åœ¨åç»­æ“ä½œä¸­ä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ªåä¸º **views** çš„ Variant å‘½åç©ºé—´ï¼Œå®ƒçš„å€¼æ˜¯æ•´æ•° Integer åŸºç¡€æ•°æ®ç±»å‹ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X PUT "http://192.168.101.252:2668/variants/views" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "variant": 0
  }'
```

å¦‚æœä¸Šé¢å‘½ä»¤æ‰§è¡ŒæˆåŠŸä¼šè¿”å› **views** å‘½åç©ºé—´åˆå§‹å€¼ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "variant created successfully",
    "data": {
        "variant": 0
    }
}
```

> [!IMPORTANT]
> åŒæ ·åœ¨åˆ›å»º Variant å‘½åç©ºé—´æ—¶å¯ä»¥æŒ‡å®š `ttl` æ¥è®¾ç½®ç”Ÿå‘½å‘¨æœŸï¼Œå…¶å€¼å•ä½ä¸ºç§’ã€‚

å½“ **views** åˆ›å»ºå¹¶åˆå§‹åŒ–æˆåŠŸåï¼Œå³å¯å¯¹å…¶æ•°å€¼æ‰§è¡Œç±»ä¼¼ Redis ä¸­çš„ INCR è‡ªå¢æ“ä½œï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X POST "http://192.168.101.252:2668/variants/views" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "delta": 1
  }'
```

å¦‚æœ INCR è‡ªå¢æ“ä½œå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "variant incremented successfully",
    "data": {
        "variant": 1
    }
}
```

> [!IMPORTANT]
> è¯·æ±‚ä½“ä¸­çš„ `delta` å€¼å¯ä»¥æ˜¯ -1 è´Ÿæ•°ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°åŸå­è‡ªå‡æ“ä½œã€‚å¦‚æœ Variant ä¸­å­˜å‚¨çš„æ˜¯ Boolen å’Œ String è¿™äº›æ“ä½œå°±ä¼šå¤±æ•ˆï¼Œå¹¶è¿”å›ç±»å‹é”™è¯¯ä¿¡æ¯ã€‚


è·å–åä¸º **views** çš„å‘½åç©ºé—´ä¸­çš„å€¼ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X GET "http://192.168.101.252:2668/variants/views" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI"
```

HTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "variant queried successfully",
    "data": {
        "variant": 1
    }
}
```


## ğŸ” Lock å‘½åç©ºé—´

> [!TIP]
> **Lock** å‘½åç©ºé—´æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç§ŸæœŸé”æœåŠ¡ï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­åè°ƒå¤šä¸ªå®¢æˆ·ç«¯å¯¹å…±äº«èµ„æºçš„è®¿é—®ï¼Œèƒ½å®ç°ç±»ä¼¼äºåŸºäº Redis å’Œ ETCD åˆ†å¸ƒå¼é”æœåŠ¡çš„åŠŸèƒ½ã€‚**Lock** å‘½åç©ºé—´ç‰¹åˆ«é€‚ç”¨äºéœ€è¦ç¡®ä¿æ•°æ®ä¸€è‡´æ€§çš„åœºæ™¯ï¼Œå¦‚åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ã€èµ„æºåˆ†é…ã€é…ç½®æ›´æ–°ç­‰æ“ä½œï¼Œä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›äº†å¯é çš„åŒæ­¥æœºåˆ¶ã€‚

Lock æä¾›çš„å®ƒæä¾›äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **äº’æ–¥é”å®š**ï¼šç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½å¤Ÿè·å–ç‰¹å®šçš„é”ã€‚
2. **è‡ªåŠ¨è¿‡æœŸ**ï¼šæ”¯æŒè®¾ç½®é”çš„è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢æ­»é”æƒ…å†µã€‚
3. **é”ç»­æœŸ**ï¼šå…è®¸æŒæœ‰é”çš„å®¢æˆ·ç«¯å»¶é•¿é”çš„æœ‰æ•ˆæœŸã€‚
4. **éé˜»å¡è·å–**ï¼šæ”¯æŒå°è¯•è·å–é”è€Œä¸é˜»å¡å½“å‰çº¿ç¨‹ã€‚
5. **é”çŠ¶æ€æŸ¥è¯¢**ï¼šå¯ä»¥æŸ¥è¯¢é”çš„å½“å‰çŠ¶æ€å’ŒæŒæœ‰è€…ä¿¡æ¯ã€‚


åœ¨ Lock å‘½åç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªåä¸º **orders** çš„åˆ†å¸ƒå¼ç§ŸæœŸé”ï¼Œé”çš„åç§°é€šå¸¸å¯¹åº”éœ€è¦ä¿æŠ¤çš„èµ„æºæ ‡è¯†ç¬¦ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡é”åç›´æ¥å…³è”åˆ°å…·ä½“çš„ä¸šåŠ¡èµ„æºã€‚é€šè¿‡ **orders** è¿™ä¸ªé”åï¼Œå¯ä»¥æ–¹ä¾¿åœ°æŸ¥è¯¢é”çš„å½“å‰çŠ¶æ€ã€æŒæœ‰è€…ä¿¡æ¯ä»¥åŠå‰©ä½™ç§ŸæœŸæ—¶é—´ï¼Œå®ç°å¯¹è®¢å•ç›¸å…³æ“ä½œçš„åˆ†å¸ƒå¼åŒæ­¥æ§åˆ¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X PUT "http://192.168.101.252:2668/locks/orders" -v \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "ttl": 30
  }'
```

å¦‚æœä¸Šé”æˆåŠŸä¼šè¿”å›å¯¹åº”é”çš„ Token å‡­è¯ï¼Œè¿™ä¸ª Token æ˜¯æ–¹ä¾¿äºå®¢æˆ·ç«¯ç»­ç§Ÿå’Œè§£é”ä½¿ç”¨çš„ï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "lock created successfully",
    "data": {
        "token": "01KBCNZY9C5XM8YDT835SHW4GN"
    }
}
```

å½“ä¸Šé”æˆåŠŸåå®¢æˆ·ç«¯å¯ä»¥å®‰å…¨åœ°æ‰§è¡Œèµ„æºç›¸å…³çš„ä¸šåŠ¡æ“ä½œï¼Œåœ¨æœ‰æ•ˆç§ŸæœŸå†…ï¼Œå®¢æˆ·ç«¯å¯¹èµ„æºçš„ç‹¬å è®¿é—®æ˜¯å—ä¿æŠ¤çš„ã€‚ä½†åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­å®¢æˆ·ç«¯çš„æ“ä½œæ—¶é—´å¯èƒ½è¶…å‡ºé¢„æœŸçš„é”ç§ŸæœŸï¼Œä¸ºäº†é˜²æ­¢é”è‡ªåŠ¨è¿‡æœŸå¯¼è‡´å…¶ä»–å®¢æˆ·ç«¯æ„å¤–è·å–é”ï¼Œå½“å®¢æˆ·ç«¯éœ€è¦å»¶é•¿æŒé”æ—¶é—´æ—¶ï¼Œåº”ä¸»åŠ¨å¯¹é”è¿›è¡Œç»­ç§Ÿæ“ä½œï¼Œç¡®ä¿åœ¨ä¸šåŠ¡å®Œæˆå‰å§‹ç»ˆä¿æŒå¯¹èµ„æºçš„ç‹¬å æ§åˆ¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X PATCH "http://192.168.101.252:2668/locks/orders" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "01KAXPB8D4MNMG731BBZ8MAV28"
  }'
```


å¦‚æœå¯¹é”ç»­ç§ŸæˆåŠŸï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "lease acquired successfully",
    "data": {
        "token": "01KBCP1V7GF9CF27PCJDEAT961"
    }
}
```

å®¢æˆ·ç«¯å¯¹æŒæœ‰çš„é”è¿›è¡Œæå‰é‡Šæ”¾å’Œè§£é”ï¼Œè§£é”æ—¶åŒæ ·éœ€è¦å¸¦æœ‰é”å¯¹åº”çš„ Token å‡­è¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```bash
curl -X DELETE "http://192.168.101.252:2668/locks/orders" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json" \
  -d '{
    "token": "01KBCP1V7GF9CF27PCJDEAT961"
  }'
```

å¦‚æœè§£é”æˆåŠŸï¼ŒHTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "lock deleted successfully"
}
```

> [!WARNING]
> æœ¬ç¯‡æ–‡æ¡£å°†å¸®åŠ©å¼€å‘è€…ç†è§£ UrnaDB æ”¯æŒçš„æ•°æ®ç»“æ„åŠå…¶å¯¹åº”çš„ HTTP API è®¾è®¡ï¼Œå€ŸåŠ©è¿™äº›ç»Ÿä¸€çš„æ¥å£ï¼Œå¼€å‘è€…å¯ä»¥åŸºäºä»»æ„ç¼–ç¨‹è¯­è¨€å®ç°è‡ªå·±çš„ SDK æˆ–è¿›ä¸€æ­¥æ‰©å±• UrnaDB çš„èƒ½åŠ›ã€‚


## ğŸŒ¡ï¸ æŒ‡æ ‡ç›‘æ§
> [!TIP]
> é™¤äº†åŸºç¡€çš„å‘½åç©ºé—´æ•°æ®æ“ä½œæ¥å£ä¹‹å¤–ï¼ŒUrnaDB è¿˜æä¾›æ–¹ä¾¿æŒ‡æ ‡ç›‘æ§ HTTP API æ¥å£ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡æ­¤æ¥å£æ¥è·å–æœåŠ¡ç«¯å¥åº·çŠ¶æ€æ•°æ®ä¿¡æ¯ã€‚


ä½¿ç”¨ **GET** ç±»å‹çš„ HTTP è¯·æ±‚å‘é€è‡³ UrnaDB çš„ `https://.../health` ç«¯ç‚¹ APIï¼Œå³å¯è¿”å›å…·ä½“çš„æŒ‡æ ‡ç›‘æ§ JSON æ•°æ®ä¿¡æ¯ï¼š

```bash
curl -X GET "http://192.168.101.252:2668/health" \
  -H "Auth-Token: yv2PH82JXfm2UpScAQK37iJVI" \
  -H "Content-Type: application/json"
```

HTTP ä¼šå“åº”è¿”å› JSON æ ¼å¼çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "status": "success",
    "message": "server is healthy",
    "data": {
        "key_count": 1,
        "gc_state": 0,
        "disk_free": "27.44GB",
        "disk_used": "85.27GB",
        "disk_total": "112.71GB",
        "mem_free": "1.95GB",
        "mem_total": "8.00GB",
        "disk_percent": "75.65%",
        "space_total": "0.00GB"
    }
}
```

